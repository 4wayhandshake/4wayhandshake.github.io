<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows on 4wayhandshake</title><link>https://4wayhandshake.github.io/categories/windows/</link><description>Recent content in Windows on 4wayhandshake</description><generator>Hugo</generator><language>en</language><copyright>&lt;a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0&lt;/a></copyright><lastBuildDate>Thu, 30 Jan 2025 00:00:01 +0000</lastBuildDate><atom:link href="https://4wayhandshake.github.io/categories/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Compiled</title><link>https://4wayhandshake.github.io/walkthrough/compiled/</link><pubDate>Fri, 31 Jan 2025 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/compiled/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>I&amp;rsquo;d like to say I had a fun time with &lt;em>Compiled&lt;/em>, but I really didn&amp;rsquo;t. It had several good learning moments, but also a lot of really painful and time-consuming steps. It was very much a &amp;ldquo;CVE box&amp;rdquo;.&lt;/p>
&lt;p>Recon was easy. The initial nmap scans tell us almost everything we need to know. Two HTTP services are found right away, and the default script scan shows the presence of a subdomain. Avoid the pitfall here of investigating one of the services too deeply without checking out the other one, too. The services are highly related to each other; it will make a lot more sense after seeing both. Remember to &lt;em>write down versions of everything&lt;/em> when you see them, and don&amp;rsquo;t skip the vuln research!&lt;/p></description></item><item><title>EscapeTwo</title><link>https://4wayhandshake.github.io/walkthrough/escapetwo/</link><pubDate>Sun, 14 Jan 2029 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/escapetwo/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>Alright! Here comes Season 7, &lt;em>Vice&lt;/em>. Our first box is Windows, rated Easy. Right away, it&amp;rsquo;s important to note that we&amp;rsquo;re provided a credential for this one, for the &lt;code>rose&lt;/code> account. With this credential, we successfully accessed SMB shares on the &lt;code>sequel.htb&lt;/code> server finding the &lt;code>Accounting Department&lt;/code> which contained garbled spreadsheets that, when opened as archives and read as raw XML, revealed a list of names and credentials. One of these credentials gave access to MS-SQL, that had &lt;code>xp_cmdshell&lt;/code> enabled - providing us a foothold of RCE.&lt;/p></description></item><item><title>Forest</title><link>https://4wayhandshake.github.io/walkthrough/forest/</link><pubDate>Tue, 29 Oct 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/forest/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;strong>&lt;em>Forest&lt;/em> is 100% Active Directory&lt;/strong>. If you&amp;rsquo;re like me, a box with no webserver and only AD is a bit like staring at a blank wall - it&amp;rsquo;s hard to know where to start with enumeration. &lt;em>Forest&lt;/em> is fantastic practice to break you out of that mindset, and help understand good methods for attacking AD environments.&lt;/p>
&lt;p>Recon mostly consists of going through checklists of ways to enumerate active directory in an unauthenticated manner. It helps a lot to know a few good methods to try, and see how far that gets you. &lt;em>Forest&lt;/em> was all about being methodical and knowing when you&amp;rsquo;ve found something useful. The only thing we really need to realize during recon is that &lt;strong>Kerberos preauthentication is disabled&lt;/strong>.&lt;/p></description></item><item><title>Freelancer</title><link>https://4wayhandshake.github.io/walkthrough/freelancer/</link><pubDate>Tue, 01 Oct 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/freelancer/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>In my opinion, &lt;em>Freelancer&lt;/em> was a very tough box. It was released as the 7th box of HTB&amp;rsquo;s Season V &lt;em>Anomalies&lt;/em>. It&amp;rsquo;s about attacking an Active Directory environment that&amp;rsquo;s running a freelancer job market website. Solving this box requires a wide array of skills. However, while a many skills are required, none of the individual steps in the solution are painfully difficult. It is a long box though, with roughly equal amounts of labour required for foothold, the user flag, and for privilege escalation.&lt;/p></description></item><item><title>SolarLab</title><link>https://4wayhandshake.github.io/walkthrough/solarlab/</link><pubDate>Wed, 11 Sep 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/solarlab/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>SolarLab&lt;/em> was released as the fourth box in HTB&amp;rsquo;s Season V &lt;em>Anomalies&lt;/em>. Although it&amp;rsquo;s rated Medium, I would rate it more like an Easy. The box is about a company of three employees that are creating an instant messaging platform. The background is largely unimportant for the solution, though.&lt;/p>
&lt;p>This box takes little to no recon. Checking the SMB share will give you want you need to get started. Reading through or spidering the initial website on port 80 will lead you towards a subdomain on another port, where you will find a nice little web challenge for exploiting inadequate input validation / sanitization and a vulnerable backend PDF-generation library. It might take a little bit of determination to find exactly the vulnerable portion of this website, but once found it is quite easy to gain RCE, and immediately after grab the user flag.&lt;/p></description></item><item><title>Pov</title><link>https://4wayhandshake.github.io/walkthrough/pov/</link><pubDate>Sat, 08 Jun 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/pov/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>HTB released &lt;em>Pov&lt;/em> during Season IV. I didn&amp;rsquo;t play that season, so I&amp;rsquo;m coming to it a few months after. I learned a lot from this box; it really helped me polish my skills for attacking Windows using a Linux box. The pathway to the root flag is very interesting, and requires a wide array of skills. Having just completed my walkthrough for &lt;em>&lt;a href="https://4wayhandshake.github.io/walkthrough/mailing/">Mailing&lt;/a>&lt;/em>, this box was refreshingly straightforward: there was no guesswork, and every step led quite logically into the next.&lt;/p></description></item><item><title>Mailing</title><link>https://4wayhandshake.github.io/walkthrough/mailing/</link><pubDate>Sat, 07 Sep 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/mailing/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Mailing&lt;/em> was released as the third box of HTB&amp;rsquo;s Season 5, &lt;em>Anomalies&lt;/em>. The box is initially about a mail server (although that ceases to be important after a foothold is achieved).&lt;/p>
&lt;p>To gain a foothold, you need to make some major assumptions using a &amp;ldquo;guess and check&amp;rdquo; procedure that is not easily automated. The foothold is possible by means of exploiting a CVE for an application that you can&amp;rsquo;t be sure is even running on the target. Moreover, the exploit requires user interaction, which you can&amp;rsquo;t be sure is even happening.&lt;/p></description></item><item><title>Crafty</title><link>https://4wayhandshake.github.io/walkthrough/crafty/</link><pubDate>Sat, 15 Jun 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/crafty/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Crafty&lt;/em> is an easy-rated Windows box, released for week 6 of HTB&amp;rsquo;s Season IV &lt;em>Savage Lands&lt;/em>. This box centers around exploitation of &lt;code>log4j&lt;/code> - maybe you&amp;rsquo;ve heard of it &amp;#x1f602; It was a really big deal in 2021. While the disaster that ensued caused heaps of damage, &lt;em>very little actually changed&lt;/em> as a result of its occurrence. If anything can be said for it, at least it stoked the international dialog on supply-chain attacks and &lt;em>the failing health of the open-source ecosystem&lt;/em>.&lt;/p></description></item><item><title>Windows PrivEsc</title><link>https://4wayhandshake.github.io/ctf/windows-privesc/</link><pubDate>Mon, 26 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/ctf/windows-privesc/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>While doing the HTB box &lt;em>&lt;a href="https://4wayhandshake.github.io/walkthrough/love/">Love&lt;/a>&lt;/em> for my my “Let’s brush up on Windows!” series, I encountered a privilege escalation technique that I had never seen. Thankfully, the technique was very clearly outlined within &lt;a href="https://tryhackme.com/room/windows10privesc">this TryHackMe room&lt;/a>. Since the room contained such a useful tip, why not go complete the whole thing?&lt;/p>
&lt;h2 id="task-1">TASK 1&lt;/h2>
&lt;h3 id="deploy-the-vm">Deploy the VM&lt;/h3>
&lt;p>Connect to the VPN and click the &lt;strong>Start Machine&lt;/strong> button to start up the VM. Oddly enough, I had trouble connecting to the VPN due to the strange way &lt;code>openvpn&lt;/code> parses its arguments - I had to specify which cipher to use:&lt;/p></description></item><item><title>Love</title><link>https://4wayhandshake.github.io/walkthrough/love/</link><pubDate>Thu, 22 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/love/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>It&amp;rsquo;s been a week, but now it&amp;rsquo;s time to get back into my “Let’s brush up on Windows!” series. &lt;em>Love&lt;/em> is the fifth box, following &lt;a href="https://4wayhandshake.github.io/walkthrough/toolbox/">&lt;em>Toolbox&lt;/em>&lt;/a>. This box was pretty interesting, definitely worth checking out. I really enjoyed that it avoided the whole &amp;ldquo;Find the CVE and exploit it&amp;rdquo; pattern that many Easy boxes use.&lt;/p>
&lt;p>It revolves around a &amp;ldquo;File Scanner&amp;rdquo; web app with some terrible security misconfigurations and mistakes. Can you find them all?&lt;/p></description></item><item><title>Toolbox</title><link>https://4wayhandshake.github.io/walkthrough/toolbox/</link><pubDate>Thu, 15 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/toolbox/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>Continuing on with my “Let’s brush up on Windows!” series, &lt;em>Toolbox&lt;/em> is the fourth box. For the previous one, see &lt;a href="https://4wayhandshake.github.io/walkthrough/buff/">my walkthrough on &lt;em>Buff&lt;/em>&lt;/a>. Unfortunately, while this box was advertised as Windows, &lt;em>it&amp;rsquo;s actually 100% Linux&lt;/em>. Yes, a little disappointing, but it&amp;rsquo;s still good practice. It might not seem like it right away, but if you have some experience with &lt;code>sqlmap&lt;/code>, then &lt;em>Toolbox&lt;/em> will be a breeze.&lt;/p>
&lt;p>Recon was very short; you are only meant to find one thing, and it appears right away. To gain a foothold, just apply a little &lt;em>ffuf-fu&lt;/em> and &lt;code>sqlmap&lt;/code> will bridge the gap. The foothold brings you straight to the user flag. From there, take a moment to fingerprint the system in front of you: a little bit of research about the system goes a long way. If you want to finish up quickly, you don&amp;rsquo;t even need to pwn the system to gain the root flag.&lt;/p></description></item><item><title>Buff</title><link>https://4wayhandshake.github.io/walkthrough/buff/</link><pubDate>Wed, 07 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/buff/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Buff&lt;/em> is the third Windows box in my “Let’s brush up on Windows!” series. For the previous one, see &lt;a href="https://4wayhandshake.github.io/walkthrough/netmon/">my walkthrough on &lt;em>Netmon&lt;/em>&lt;/a>. This box houses a web app for a fictional gym / fitness center. It&amp;rsquo;s fairly easy, but requires good Windows enumeration fundamentals. Following any reasonable pentest checklist will secure a victory on this box.&lt;/p>
&lt;p>Recon is fairly unimportant with &lt;em>Buff&lt;/em>. Foothold is achieved with hardly more than a few clicks and a CVE, and leads directly to the user flag. The root flag is a little more challenging, requiring some local enumeration on the box and application of another CVE. The solution is fairly straightforward: just stick to your checklists and you&amp;rsquo;ll grab that root flag quickly.&lt;/p></description></item><item><title>Netmon</title><link>https://4wayhandshake.github.io/walkthrough/netmon/</link><pubDate>Mon, 05 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/netmon/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Netmon&lt;/em> is the second Windows box in my &amp;ldquo;Let&amp;rsquo;s brush up on Windows!&amp;rdquo; series. For the previous one, see &lt;a href="https://4wayhandshake.github.io/walkthrough/blue/">my walkthrough on &lt;em>Blue&lt;/em>&lt;/a>. This box revolves around a network monitoring tool called &lt;strong>PRTG&lt;/strong>. It&amp;rsquo;s very easy, and a great reintroduction to Windows tools. Recon leads straight into the user flag, skipping any necessity of acquiring a foothold.&lt;/p>
&lt;p>If recon was done properly, there are only a few options to follow when seeking the root flag. Thankfully, these options have very few rabbit-holes. Keep it simple, don&amp;rsquo;t dig in your heels on any particular method, and you&amp;rsquo;ll find yourself in possession of the root flag in no time at all! Just remember: &lt;em>while software and vulnerabilities change all the time, human habits are much less volatile&lt;/em>.&lt;/p></description></item><item><title>Blue</title><link>https://4wayhandshake.github.io/walkthrough/blue/</link><pubDate>Mon, 05 Feb 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/blue/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Blue&lt;/em> is a retired Windows box, the first box in my “Let’s brush up on Windows!” series. It ranks as one of the easiest Windows boxes. I&amp;rsquo;m going to do a whole spree of boxes to try to brush up on my Windows technique. In the end, this box was more of an exercise in trying a whole bunch of exploits and dealing with really messed-up python environments.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>tldr;&lt;/strong>
If you&amp;rsquo;re doing this box in 2024 or later, go straight to a more recent version of the exploit. After you finish Recon, &lt;a href="https://4wayhandshake.github.io/walkthrough/blue/#running-eternalblue">just skip right to this part of the walkthrough&lt;/a>.&lt;/p></description></item><item><title>Authority</title><link>https://4wayhandshake.github.io/walkthrough/authority/</link><pubDate>Wed, 24 Jan 2024 00:00:00 +0000</pubDate><guid>https://4wayhandshake.github.io/walkthrough/authority/</guid><description>&lt;h2 id="introduction">INTRODUCTION&lt;/h2>
&lt;p>&lt;em>Authority&lt;/em> was released as the fifth box of HTB&amp;rsquo;s &lt;em>Hackers Clash: Open Beta Season II&lt;/em>. Is a &amp;ldquo;Medium&amp;rdquo; Windows box, but will serve as a formidable challenge to any players unfamiliar with Windows. &lt;em>Authority&lt;/em> features a typical Microsoft environment, including Microsoft IIS server, LDAP, Kerberos, and SMB. No SSH here! You&amp;rsquo;ll have to rely on more rudimentary remote-connection methods. This box will test your filesystem enumeration skills, but not as much as your PKI knowledge. Get ready to think like a sysadmin.&lt;/p></description></item></channel></rss>